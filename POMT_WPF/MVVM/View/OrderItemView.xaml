<UserControl
    x:Class="POMT_WPF.MVVM.View.OrderItemView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:convert="clr-namespace:POMT_WPF.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:POMT_WPF.MVVM.View.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DesignHeight="700"
    d:DesignWidth="860"
    mc:Ignorable="d">

    <UserControl.Resources>
        <convert:StringToBoolConverter x:Key="StringToBoolConverter" />
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <convert:StringToIntConverter x:Key="StringToIntConverter" />
        <convert:InvertBoolConverter x:Key="InvertBool" />

        <DataTemplate x:Key="OrderFormItemNameTemplate">
            <Grid>
                <ComboBox
                    x:Name="ItemNameComboBox"
                    Width="120"
                    Height="40"
                    IsEditable="True"
                    IsHitTestVisible="False"
                    IsReadOnly="False"
                    StaysOpenOnEdit="True"
                    Text="{Binding ElementName=ItemNameTextBox, Path=Text}" />
                <local:TextFillTextBox
                    x:Name="ItemNameTextBox"
                    Background="{StaticResource MintCream}"
                    IsReadOnly="{Binding IsReadOnly, UpdateSourceTrigger=PropertyChanged}"
                    Style="{StaticResource orderFormItemnameTextFillTextBox}"
                    Text="{Binding ItemName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    TextChanged="ItemNameTextBox_TextChanged"
                    TextFill="Item Name ..." />
            </Grid>
        </DataTemplate>
    </UserControl.Resources>

    <Grid Background="{StaticResource ColumbiaBlue}">

        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <!--  BACK  -->
            <Button
                Name="BackButton"
                Margin="5"
                HorizontalAlignment="Left"
                Command="{Binding BackCommand}">
                <Icon:PackIconMaterial Kind="ChevronLeft" />
            </Button>
            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <!--  FREEZE  -->
                <ToggleButton
                    x:Name="FreezeToggleButton"
                    Width="60"
                    Height="20"
                    Margin="0,5,50,5"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Content="Freeze"
                    IsChecked="{Binding IsFrozen, Mode=TwoWay}"
                    Style="{StaticResource orderFormFreezeButton}"
                    Visibility="{Binding CanModify, Converter={StaticResource BoolToVis}}" />
                <!--  EDIT  -->
                <ToggleButton
                    x:Name="EditToggleButton"
                    Width="60"
                    Height="20"
                    Margin="0,5,20,5"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Content="Edit"
                    IsChecked="{Binding IsEdit, Mode=TwoWay}"
                    Style="{StaticResource orderFormEditButton}"
                    Visibility="{Binding CanModify, Converter={StaticResource BoolToVis}}" />
            </StackPanel>
        </Grid>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="auto" />
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <StackPanel Margin="10" Orientation="Vertical">
                    <StackPanel Orientation="Vertical">
                        <Label Content="Recipient" />
                        <TextBox
                            IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                            Style="{StaticResource GeneralField}"
                            Text="{Binding Recipient, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />

                    </StackPanel>
                    <StackPanel Orientation="Vertical">
                        <Label Content="Email" />
                        <TextBox
                            IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                            Style="{StaticResource GeneralField}"
                            Text="{Binding Email, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                    </StackPanel>
                    <StackPanel Orientation="Vertical">
                        <Label Content="Phone" />
                        <TextBox
                            IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                            Style="{StaticResource GeneralField}"
                            Text="{Binding PhoneNumber, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                    </StackPanel>
                </StackPanel>
            </Grid>
            <Grid Grid.Column="1">
                <StackPanel Margin="10" Orientation="Vertical">
                    <StackPanel Orientation="Vertical">
                        <Label Content="Fulfillment Date" />
                        <Border Style="{StaticResource GeneralBorder}">
                            <DatePicker
                                x:Name="OrderDatePicker"
                                Width="200"
                                Height="40"
                                Focusable="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                Foreground="Black"
                                IsHitTestVisible="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                SelectedDate="{Binding FulfillmentDate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </Border>
                    </StackPanel>
                    <StackPanel Orientation="Vertical">
                        <Label Content="Time" />
                        <TextBox
                            IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                            Style="{StaticResource GeneralField}"
                            Text="{Binding Time, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                    </StackPanel>
                    <StackPanel Orientation="Vertical">
                        <Label Content="Delivery Address" />
                        <TextBox
                            IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                            Style="{StaticResource GeneralField}"
                            Text="{Binding DeliveryAddr, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                    </StackPanel>
                </StackPanel>
            </Grid>
            <Grid Grid.Column="2">
                <StackPanel Margin="10" Orientation="Vertical">
                    <StackPanel Orientation="Vertical">
                        <Label Content="Order Type" />
                        <Border Style="{StaticResource GeneralBorder}">
                            <ComboBox
                                x:Name="OrderTypeComboBox"
                                Width="200"
                                Height="40"
                                Background="{StaticResource MintCream}"
                                IsHitTestVisible="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                ItemsSource="{Binding Path=OrderTypes}"
                                SelectedItem="{Binding Path=OrderType, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </Border>
                    </StackPanel>
                    <StackPanel Orientation="Vertical">
                        <Label Content="Fulfillment Type" />
                        <Border Style="{StaticResource GeneralBorder}">
                            <ComboBox
                                x:Name="FulfillmentTypeComboBox"
                                Width="200"
                                Height="40"
                                Background="{StaticResource MintCream}"
                                IsHitTestVisible="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                ItemsSource="{Binding Path=FulfillmentTypes}"
                                SelectedItem="{Binding Path=FulfillmentType, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </Border>
                    </StackPanel>
                    <StackPanel Orientation="Vertical">
                        <Label Content="Order Frequency" />
                        <Border Style="{StaticResource GeneralBorder}">
                            <ComboBox
                                x:Name="OrderFrequencyTypeComboBox"
                                Width="200"
                                Height="40"
                                Background="{StaticResource MintCream}"
                                IsHitTestVisible="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                ItemsSource="{Binding Path=OrderFrequencies}"
                                SelectedItem="{Binding OrderFrequency, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Grid>
            <Grid Grid.Column="3">
                <StackPanel Margin="10" Orientation="Vertical">
                    <StackPanel Orientation="Vertical">
                        <Label Content="Notes" />
                        <Border Style="{StaticResource GeneralBorder}">
                            <TextBox
                                Height="175"
                                IsReadOnly="{Binding IsEdit, Converter={StaticResource InvertBool}}"
                                Style="{StaticResource GeneralTextBox}"
                                Text="{Binding Notes, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </Border>

                    </StackPanel>
                </StackPanel>
            </Grid>
        </Grid>
        <Grid x:Name="dataGridGrid" Grid.Row="3">
            <StackPanel Orientation="Vertical">
                <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                    <DataGrid
                        x:Name="orderFormDataGrid"
                        Width="800"
                        Height="350"
                        BorderBrush="Transparent"
                        CellStyle="{DynamicResource orderFormDataGridCellStyle}"
                        ColumnHeaderStyle="{DynamicResource orderFormDataGridColumnHeaderStyle}"
                        ItemsSource="{Binding LineItems}"
                        RowStyle="{DynamicResource orderFormDataGridRowStyle}"
                        Style="{DynamicResource orderFormGridStyle}">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn
                                x:Name="orderFormTemplate"
                                Width="auto"
                                CellTemplate="{StaticResource OrderFormItemNameTemplate}"
                                Header="Item Name" />
                            <DataGridTemplateColumn Width="*" Header="Regular">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <local:TextFillTextBox
                                            x:Name="amountRegTextBox"
                                            Background="{StaticResource MintCream}"
                                            IsReadOnly="{Binding IsReadOnly, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource orderFormTextFillTextBox}"
                                            Text="{Binding AmountRegular, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StringToIntConverter}, Mode=TwoWay}"
                                            TextFill="Regular ..." />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="*" Header="Amount 3">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <local:TextFillTextBox
                                            x:Name="amount3TextBox"
                                            Background="{StaticResource MintCream}"
                                            IsReadOnly="{Binding IsReadOnly, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource orderFormTextFillTextBox}"
                                            Text="{Binding Amount3, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StringToIntConverter}, Mode=TwoWay}"
                                            TextFill="Amount 3 ..." />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="*" Header="Amount 5">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <local:TextFillTextBox
                                            x:Name="amount5TextBox"
                                            Background="{StaticResource MintCream}"
                                            IsReadOnly="{Binding IsReadOnly, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource orderFormTextFillTextBox}"
                                            Text="{Binding Amount5, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StringToIntConverter}, Mode=TwoWay}"
                                            TextFill="Amount 5 ..." />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="*" Header="Amount 8">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <local:TextFillTextBox
                                            x:Name="amount8TextBox"
                                            Background="{StaticResource MintCream}"
                                            IsReadOnly="{Binding IsReadOnly, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource orderFormTextFillTextBox}"
                                            Text="{Binding Amount8, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StringToIntConverter}, Mode=TwoWay}"
                                            TextFill="Amount 8 ..." />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="*" Header="Amount 10">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <local:TextFillTextBox
                                            x:Name="amount10TextBox"
                                            Background="{StaticResource MintCream}"
                                            IsReadOnly="{Binding IsReadOnly, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource orderFormTextFillTextBox}"
                                            Text="{Binding Amount10, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource StringToIntConverter}, Mode=TwoWay}"
                                            TextFill="Amount 10 ..." />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!--<DataGridTextColumn Header="Item Name" IsReadOnly="True" CanUserResize="False" Width="*" Binding="{Binding ItemName}"/>
                <DataGridTextColumn Header="Amount 3" IsReadOnly="True" CanUserResize="False" Width="*" Binding="{Binding Amount3}" />
                <DataGridTextColumn Header="Amount 5" IsReadOnly="True" CanUserResize="False" Width="*" Binding="{Binding Amount5}" />
                <DataGridTextColumn Header="Amount 8" IsReadOnly="True" CanUserResize="False" Width="*" Binding="{Binding Amount8}" />
                <DataGridTextColumn Header="Amount 10" IsReadOnly="True" CanUserResize="False" Width="*" Binding="{Binding Amount10}" />-->
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Orientation="Vertical">
                        <Button
                            Name="AddLineButton"
                            Width="30"
                            Height="30"
                            Margin="5,0,5,5"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Command="{Binding AddLineCommand}"
                            IsHitTestVisible="{Binding IsEdit}"
                            Style="{StaticResource secondaryButton}"
                            Visibility="{Binding CanModify, Converter={StaticResource BoolToVis}}">
                            <Icon:PackIconMaterial Kind="Plus" />
                        </Button>
                        <Button
                            Name="DeleteLineButton"
                            Width="30"
                            Height="30"
                            Margin="5,0,5,5"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Background="{StaticResource ChiliRed}"
                            Command="{Binding DeleteLineCommand}"
                            CommandParameter="{Binding ElementName=orderFormDataGrid, Path=SelectedItem}"
                            IsHitTestVisible="{Binding IsEdit}"
                            Style="{StaticResource secondaryButton}"
                            Visibility="{Binding CanModify, Converter={StaticResource BoolToVis}}">
                            <Icon:PackIconMaterial Kind="Minus" />
                        </Button>
                    </StackPanel>
                </StackPanel>
                <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                    <Border Margin="5,5,10,5" Style="{StaticResource GeneralBorder}">
                        <TextBlock
                            Width="50"
                            Height="40"
                            Background="{StaticResource MintCream}"
                            Foreground="{StaticResource maybeDark}"
                            IsHitTestVisible="False"
                            Text="{Binding TotalAmountReg}" />
                    </Border>

                    <Border
                        Margin="10,5,10,5"
                        BorderBrush="{StaticResource maybeDark}"
                        BorderThickness="1"
                        CornerRadius="5">
                        <TextBlock
                            Width="50"
                            Height="40"
                            Background="{StaticResource MintCream}"
                            Foreground="{StaticResource maybeDark}"
                            IsHitTestVisible="False"
                            Text="{Binding TotalAmount3}" />
                    </Border>

                    <Border
                        Margin="10,5,10,5"
                        BorderBrush="{StaticResource maybeDark}"
                        BorderThickness="1"
                        CornerRadius="5">
                        <TextBlock
                            Width="50"
                            Height="40"
                            Background="{StaticResource MintCream}"
                            Foreground="{StaticResource maybeDark}"
                            IsHitTestVisible="False"
                            Text="{Binding TotalAmount5}" />
                    </Border>

                    <Border
                        Margin="10,5,10,5"
                        BorderBrush="{StaticResource maybeDark}"
                        BorderThickness="1"
                        CornerRadius="5">
                        <TextBlock
                            Width="50"
                            Height="40"
                            Background="{StaticResource MintCream}"
                            Foreground="{StaticResource maybeDark}"
                            IsHitTestVisible="False"
                            Text="{Binding TotalAmount8}" />
                    </Border>

                    <Border
                        Margin="10,5,10,5"
                        BorderBrush="{StaticResource maybeDark}"
                        BorderThickness="1"
                        CornerRadius="5">
                        <TextBlock
                            Width="50"
                            Height="40"
                            Background="{StaticResource MintCream}"
                            Foreground="{StaticResource maybeDark}"
                            IsHitTestVisible="False"
                            Text="{Binding TotalAmount10}" />
                    </Border>

                </StackPanel>
            </StackPanel>
        </Grid>
        <!--  Visibility="{Binding CanDelete, Converter={StaticResource BoolToVis}}"  -->
        <Grid Grid.Row="4">
            <Button
                Name="SaveOrderButton"
                HorizontalAlignment="Center"
                Command="{Binding SaveOrderCommand}"
                Content="Save"
                Style="{StaticResource secondaryButton}"
                Visibility="{Binding CanModify, Converter={StaticResource BoolToVis}}" />
            <Button
                Name="DeleteOrderButton"
                Margin="100,10,10,0"
                HorizontalAlignment="Right"
                Background="{StaticResource ChiliRed}"
                Command="{Binding DeleteOrderCommand}"
                Content="Delete"
                Style="{StaticResource secondaryButton}"
                Visibility="{Binding CanDelete, Converter={StaticResource BoolToVis}}" />
        </Grid>
    </Grid>
</UserControl>
